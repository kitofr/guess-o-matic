<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>Guess-o-Matic</title>
  <script type="text/javascript" src="elm.js"></script>
</head>

<body>
  <div id="elm-app-lives-here"></div>

<script type="text/javascript">
  var elmDiv = document.getElementById('elm-app-lives-here');
  var elmApp = Elm.embed(Elm.Main, elmDiv);

  var playSound = function(what){
    var snd = new Audio("./sounds/" + what + ".mp3");
    snd.play();
  };

  var fix_swedish = function(ch) {
    var ret = ch;
    switch(ch) {
      case 'å': 
        ret = "aa";
        break;
      case 'ä':
        ret = "ae";
        break;
      case 'ö':
        ret = "oe";
        break;
    }
    return ret;
  };
  elmApp.ports.guessChanges.subscribe(function(guess) {
    var ch = guess.slice(-1).toLowerCase();
    console.log(guess);
    if(ch)
      playSound(fix_swedish(ch));
  });

  elmApp.ports.correct.subscribe(function(isCorrect) {

    console.log(isCorrect);
    if(!isCorrect)
      return;
    window.setTimeout(function(){
      playSound('tada');
    }, 500);
  });

</script>

</body>
</html>
