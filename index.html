<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <title>Guess-o-Matic</title>
  <script type="text/javascript" src="elm.js"></script>
</head>

<body>
  <div id="elm-app-lives-here"></div>

<script type="text/javascript">
  var elmDiv = document.getElementById('elm-app-lives-here');
  var elmApp = Elm.Main.embed(elmDiv);

  console.log("things loaded");

  var playSound = function(what, ext){
    ext = ext ? ext : ".mp3";
    var snd = new Audio("./sounds/" + what + ext);
    snd.play();
  };

  var fixSwedish = function(ch) {
    var ret = ch;
    switch(ch) {
      case 'å':
        ret = "aa";
        break;
      case 'ä':
        ret = "ae";
        break;
      case 'ö':
        ret = "oe";
        break;
    }
    return ret;
  };

  elmApp.ports.playChar.subscribe(function(ch) {
    console.log("Playing: " + ch);
    if(ch)
      playSound(fixSwedish(ch.toLowerCase()));
  });

  elmApp.ports.correct.subscribe(function(isCorrect) {
    if(isCorrect)
      playSound('stapler', '.wav');
  });

</script>

</body>
</html>
